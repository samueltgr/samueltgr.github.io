<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Centered Year Calendar</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #f8fafc;
      --panel: #ffffff;
      --muted: #64748b;
      --ink: #0f172a;
      --line: #e2e8f0;
      --ring: #94a3b8;
      --shadow: 0 10px 20px rgba(2,6,23,.06), 0 2px 6px rgba(2,6,23,.04);
      --radius: 16px;
      --ease: cubic-bezier(.2,.8,.2,1);
      --gap: 6px;
      --topbar: 56px; /* fixed toolbar height */
    }
    *{box-sizing:border-box}
    html,body{width:100svw;height:100svh;overflow:hidden}
    body{
      margin:0;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background: linear-gradient(#fff, var(--bg));
      color: var(--ink);
      display:flex;flex-direction:column;
      width:100svw;height:100svh;
    }

    /* Top bar (fixed height) */
    .topbar{flex:0 0 var(--topbar);height:var(--topbar);backdrop-filter:saturate(1.2) blur(6px);background:rgba(255,255,255,.9);border-bottom:1px solid var(--line);z-index:10}
    .toprow{height:100%;display:flex;align-items:center;justify-content:space-between;padding:0 20px}
    .brand{display:flex;gap:10px;align-items:center}
    .brand svg{width:24px;height:24px}
    .title{font-weight:600;font-size:18px;letter-spacing:-.01em}
    .navbtn{border:none;background:transparent;padding:8px;border-radius:14px;cursor:pointer;transition:background .2s var(--ease), transform .2s var(--ease)}
    .navbtn:hover{background:rgba(15,23,42,.05)}
    .navbtn:active{transform:translateY(1px)}
    .navbtn svg{width:20px;height:20px;stroke:#0f172a}

    /* Main stage fills the rest of the viewport exactly */
    main{flex:1 1 auto;min-height:0; /* allow child to size within */ height:calc(100svh - var(--topbar)); width:100svw; display:flex; flex-direction:column; padding:12px 16px}

    .hint{color:var(--muted);font-size:13px;margin:0 0 8px 2px;flex:0 0 auto}

    /* Grid consumes all remaining space without scrolling */
    .gridwrap{position:relative;flex:1 1 auto;min-height:0}
    .gridpane{position:absolute;inset:0;overflow:hidden}
    .grid{display:grid;grid-template-columns:repeat(4,1fr);grid-auto-rows:1fr;gap:12px;height:100%;width:100%}

    /* Card occupies its grid cell fully */
    .card{height:100%;width:100%;display:flex;flex-direction:column;background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .card.highlight{outline:1px solid #cbd5e1}
    .card-head{flex:0 0 auto;padding:8px 12px;border-bottom:1px solid #f1f5f9}
    .card-title{font-weight:600;font-size:14px;display:flex;align-items:center;justify-content:space-between}
    .card-body{flex:1 1 auto;min-height:0;padding:8px 10px 10px;display:flex}

    /* Month grid is 7 (weekdays) + 6 rows of days = 7 rows */
    .month{display:grid;grid-template-columns:repeat(7,1fr);gap:var(--gap);align-content:center;justify-content:center;margin:auto}
    .wday{color:#94a3b8;text-align:center;font-weight:600;font-size:11px}
    .cells{grid-column:1 / -1; display:grid; grid-template-columns:repeat(7,1fr); gap:var(--gap)}
    .cell{border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:11px;color:#334155;background:#fff;transition:background .2s var(--ease), box-shadow .2s var(--ease), transform .2s var(--ease)}
    .cell.dim{background:#f1f5f9;color:#cbd5e1}
    .cell:hover{background:#f8fafc}
    .cell.today{outline:1px solid var(--ring);font-weight:600}

    /* Animations for the whole 12-month view */
    .fade-enter{opacity:0;transform:translateY(12px)}
    .fade-enter.fade-enter-active{opacity:1;transform:translateY(0);transition:opacity .25s var(--ease), transform .25s var(--ease)}
    .fade-exit{opacity:1;transform:translateY(0)}
    .fade-exit.fade-exit-active{opacity:0;transform:translateY(-12px);transition:opacity .2s var(--ease), transform .2s var(--ease)}
  </style>
</head>
<body>
  <header class="topbar">
    <div class="toprow">
      <div class="brand" aria-label="Calendar App Brand">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
          <rect x="3" y="4" width="18" height="18" rx="3" ry="3"></rect>
          <line x1="16" y1="2" x2="16" y2="6"></line>
          <line x1="8" y1="2" x2="8" y2="6"></line>
          <line x1="3" y1="10" x2="21" y2="10"></line>
        </svg>
        <div class="title">Centered Year</div>
      </div>
      <div>
        <button id="prevBtn" class="navbtn" aria-label="Previous month window" title="Previous">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
        </button>
        <button id="nextBtn" class="navbtn" aria-label="Next month window" title="Next">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
        </button>
      </div>
    </div>
  </header>

  <main>
    <p id="hint" class="hint">&nbsp;</p>
    <div class="gridwrap" aria-live="polite">
      <div id="gridMount" class="gridpane"></div>
    </div>
  </main>

  <script>
    /** Utilities **/
    const WEEKDAYS = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]; // Monday-first

    function addMonths(date, count){
      const d = new Date(date);
      d.setMonth(d.getMonth() + count);
      return d;
    }
    function startOfMonth(date){
      const d = new Date(date);
      d.setDate(1); d.setHours(0,0,0,0); return d;
    }
    function endOfMonth(date){
      const d = new Date(date); d.setMonth(d.getMonth()+1,0); d.setHours(23,59,59,999); return d;
    }
    function formatMonthYear(date){
      return date.toLocaleDateString(undefined,{year:'numeric', month:'long'});
    }
    function getMonthGrid(date){
      const first = startOfMonth(date);
      const jsFirstDow = first.getDay();
      const monFirstDow = (jsFirstDow + 6) % 7; // Sun=0..Sat=6 -> Mon=0..Sun=6
      const leading = monFirstDow;
      const totalCells = 42; // 6 weeks * 7 days
      const cells = [];
      const gridStart = new Date(first);
      gridStart.setDate(first.getDate() - leading);
      const now = new Date();
      for(let i=0;i<totalCells;i++){
        const d = new Date(gridStart);
        d.setDate(gridStart.getDate()+i);
        const inCurrentMonth = d.getMonth() === date.getMonth();
        const isToday = d.getFullYear()===now.getFullYear() && d.getMonth()===now.getMonth() && d.getDate()===now.getDate();
        cells.push({date:d,inCurrentMonth,isToday});
      }
      const rows=[]; for(let r=0;r<6;r++) rows.push(cells.slice(r*7, r*7+7));
      return rows;
    }

    const gridMount = document.getElementById('gridMount');
    const hintEl = document.getElementById('hint');
    let offset = 0; // shifts the entire 12-month window
    const today = new Date();

    function buildMonthCard(date, highlight){
      const card = document.createElement('section');
      card.className = 'card' + (highlight ? ' highlight' : '');
      const head = document.createElement('div'); head.className = 'card-head';
      const title = document.createElement('div'); title.className = 'card-title'; title.textContent = formatMonthYear(date);
      head.appendChild(title);
      const body = document.createElement('div'); body.className = 'card-body';

      const month = document.createElement('div'); month.className = 'month';
      const wdays = document.createElement('div'); wdays.className = 'wday-row';
      // Weekday headers (rendered within .month grid as 7 items)
      WEEKDAYS.forEach(wd=>{
        const el = document.createElement('div'); el.className = 'wday'; el.textContent = wd; month.appendChild(el);
      });

      const cellsWrap = document.createElement('div'); cellsWrap.className = 'cells';
      for(const week of getMonthGrid(date)){
        for(const cell of week){
          const d = document.createElement('div');
          d.className = 'cell' + (cell.inCurrentMonth ? '' : ' dim') + (cell.isToday ? ' today' : '');
          d.title = cell.date.toDateString();
          d.textContent = String(cell.date.getDate());
          cellsWrap.appendChild(d);
        }
      }
      month.appendChild(cellsWrap);

      body.appendChild(month);
      card.appendChild(head); card.appendChild(body);
      return card;
    }

    function render(){
      // Update hint text
      const a = addMonths(today, offset);
      const b = addMonths(today, offset+1);
      hintEl.innerHTML = `The center two tiles are <span style="font-weight:600;color:#334155">${formatMonthYear(a)}</span> and <span style="font-weight:600;color:#334155">${formatMonthYear(b)}</span>.`;

      const firstMonth = addMonths(today, -5 + offset);
      const months = Array.from({length:12}, (_,i)=> addMonths(firstMonth, i));

      const grid = document.createElement('div');
      grid.className = 'grid fade-enter';

      months.forEach((m, idx)=>{
        const card = buildMonthCard(m, idx===5 || idx===6);
        grid.appendChild(card);
      });

      // Transition swap
      const prev = gridMount.firstElementChild;
      if(prev){
        prev.classList.remove('fade-enter','fade-enter-active');
        prev.classList.add('fade-exit');
        void prev.offsetWidth; // reflow
        prev.classList.add('fade-exit-active');
        prev.addEventListener('transitionend', ()=>{
          if(prev.parentNode) prev.parentNode.removeChild(prev);
        }, {once:true});
      }

      gridMount.appendChild(grid);
      requestAnimationFrame(()=>{
        grid.classList.add('fade-enter-active');
        fitCells();
      });
    }

    // Compute cell sizes so 4x3 grid fits perfectly into 100svw x 100svh without scroll
    function fitCells(){
      const pane = gridMount.firstElementChild; if(!pane) return;
      const cards = pane.querySelectorAll('.card');
      if(cards.length===0) return;

      // Measure a card to determine available inner height
      cards.forEach(card=>{
        const head = card.querySelector('.card-head');
        const body = card.querySelector('.card-body');
        const month = card.querySelector('.month');
        const cellsWrap = card.querySelector('.cells');
        if(!head || !body || !month || !cellsWrap) return;
        // Available height for month content inside body
        const bodyStyles = getComputedStyle(body);
        const bodyPad = parseFloat(bodyStyles.paddingTop) + parseFloat(bodyStyles.paddingBottom);
        const availH = body.clientHeight - bodyPad; // inside body

        // We need 1 row for weekdays + 6 rows for days = 7 rows, with gaps between rows (6 gaps)
        const gaps = 6 * parseFloat(getComputedStyle(month).gap || '6');
        const cellSizeByHeight = Math.floor((availH - gaps) / 7);

        // Also constrain by width of the card
        const cellsGap = 6 * parseFloat(getComputedStyle(cellsWrap).gap || '6');
        const availW = cellsWrap.clientWidth - cellsGap; // 7 columns -> 6 gaps
        const cellSizeByWidth = Math.floor(availW / 7);

        const size = Math.max(10, Math.min(cellSizeByHeight, cellSizeByWidth));
        // Apply width/height to each cell and to weekday row height
        cellsWrap.querySelectorAll('.cell').forEach(el=>{
          el.style.width = size + 'px';
          el.style.height = size + 'px';
          el.style.fontSize = (size > 18 ? 12 : 10) + 'px';
          el.style.borderRadius = Math.max(6, Math.round(size*0.18)) + 'px';
        });
        month.querySelectorAll('.wday').forEach(el=>{
          el.style.height = Math.round(size * 0.9) + 'px';
          el.style.lineHeight = Math.round(size * 0.9) + 'px';
          el.style.fontSize = (size > 18 ? 11 : 10) + 'px';
        });
      });
    }

    // Recompute on resize to maintain no-overflow guarantee
    addEventListener('resize', ()=>{ fitCells(); });

    // Nav buttons
    document.getElementById('prevBtn').addEventListener('click', ()=>{ offset -= 1; render(); });
    document.getElementById('nextBtn').addEventListener('click', ()=>{ offset += 1; render(); });

    // Initial paint
    render();
  </script>
</body>
</html>
